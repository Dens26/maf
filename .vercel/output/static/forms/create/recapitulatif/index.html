<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="sitemap" href="/sitemap-index.xml"><link rel="canonical" href="https://www.mon-assistant-formalites.fr/forms/create/recapitulatif/"><meta name="generator" content="Astro v5.17.3"><title>Création | Mon Assistant Formalités </title><meta name="description" content="Creez votre entreprise"><meta name="robots" content="index, follow"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Bruno+Ace+SC&family=Noto+Sans+KR:wght@100..900&display=swap" rel="stylesheet"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://www.mon-assistant-formalites.fr/forms/create/recapitulatif/"><meta property="og:title" content="Création | Mon Assistant Formalités "><meta property="og:description" content="Creez votre entreprise"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://www.mon-assistant-formalites.fr/forms/create/recapitulatif/"><meta property="twitter:title" content="Création | Mon Assistant Formalités "><meta property="twitter:description" content="Creez votre entreprise"><link rel="stylesheet" href="/_astro/_page_.ByKBJD1h.css"></head> <body data-theme="hermes"> <header class="fixed top-0 z-50 w-full left-0"> <div class="site-container mx-auto px-4 mt-4"> <div class="flex justify-between items-center bg-white py-4 rounded-lg px-4 border-black border"> <a href="/" class="logo uppercase font-logo transition-colors duration-200 font-light text-header-logo hover:text-primary">  <img src="/_astro/astro.CXuftnGC_ZFt1Ax.svg" alt loading="lazy" decoding="async" fetchpriority="auto" width="115" height="48" class="hidden"> <div class="full-logo"><span class="font-bold">Mon Assistant</span> Formalités</div> <div class="min-logo"><span class="font-bold">MAF</span></div> </a> <nav class="relative flex items-center gap-2 lg:gap-8" aria-label="Site Navigation">  <ul class="hidden lg:flex lg:gap-8 items-center"> <li class="relative group"> <div class="flex items-center gap-1"> <a href="/team/denis" class="text-small font-medium rounded-md px-2 py-1 focus:outline-none focus:ring-2 focus:ring-nav-text-active text-nav-text hover:text-nav-text-hover"> A propos </a>  </div>  </li><li class="relative group"> <div class="flex items-center gap-1"> <a href="/services" class="text-small font-medium rounded-md px-2 py-1 focus:outline-none focus:ring-2 focus:ring-nav-text-active text-nav-text hover:text-nav-text-hover"> Services </a>  </div>  </li><li class="relative group"> <div class="flex items-center gap-1"> <a href="/blog" class="text-small font-medium rounded-md px-2 py-1 focus:outline-none focus:ring-2 focus:ring-nav-text-active text-nav-text hover:text-nav-text-hover"> Articles </a>  </div>  </li> </ul> <a href="/contact" class="group relative inline-flex overflow-hidden items-center justify-center rounded-border-small font-medium transition-all duration-300 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 rounded-md flex items-center gap-2 bg-primary text-white hover:bg-primary-light focus-visible:ring-primary hover:ring-2 hover:ring-primary hover:ring-offset-2 h-10 px-4 py-2 text-small " aria-disabled="false"> <span class="absolute left-0 -mt-12 h-32 w-1/2 translate-x-[250%] rotate-12 bg-white opacity-20 transition-all duration-250 ease-out group-hover:translate-x-[2%]"></span> Me contacter </a>  <button class="mobile-menu-button relative z-30 p-2 border-none cursor-pointer bg-transparent lg:hidden" aria-label="Toggle Menu" aria-expanded="false"> <span class="menu-icon block"> <svg xmlns="http://www.w3.org/2000/svg" stroke-width="2" width="24" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="none" viewBox="0 0 24 24" class="lucide lucide-menu text-body-base">  <line x1="4" x2="20" y1="12" y2="12"></line> <line x1="4" x2="20" y1="6" y2="6"></line> <line x1="4" x2="20" y1="18" y2="18"></line>  </svg> </span> <span class="close-icon hidden"> <svg xmlns="http://www.w3.org/2000/svg" stroke-width="2" width="24" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="none" viewBox="0 0 24 24" class="lucide lucide-x text-white">  <path d="M18 6 6 18"></path> <path d="m6 6 12 12"></path>  </svg> </span> </button>  <div class="mobile-menu fixed inset-0 z-20 px-8 pt-20 bg-primary lg:hidden hidden opacity-0 scale-95 transform transition-all duration-200 ease-out overflow-y-auto"> <ul class="flex flex-col gap-4"> <li> <div class="text-white"> <div class="flex items-center justify-between"> <a href="/team/denis" class="py-1 rounded-md focus:outline-none focus:ring-2 focus:ring-nav-mobile-text-active text-nav-mobile-text hover:text-nav-mobile-text-hover"> A propos </a>  </div>  </div> </li><li> <div class="text-white"> <div class="flex items-center justify-between"> <a href="/services" class="py-1 rounded-md focus:outline-none focus:ring-2 focus:ring-nav-mobile-text-active text-nav-mobile-text hover:text-nav-mobile-text-hover"> Services </a>  </div>  </div> </li><li> <div class="text-white"> <div class="flex items-center justify-between"> <a href="/blog" class="py-1 rounded-md focus:outline-none focus:ring-2 focus:ring-nav-mobile-text-active text-nav-mobile-text hover:text-nav-mobile-text-hover"> Articles </a>  </div>  </div> </li> </ul>  <div class="mt-8 pb-8"> <a href="/contact" class="group relative inline-flex overflow-hidden items-center justify-center rounded-border-small font-medium transition-all duration-300 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 rounded-md flex items-center gap-2 text-white ring-2 ring-white focus-visible:ring-white hover:ring-2 hover:ring-black hover:ring-offset-2 h-10 px-4 py-2 text-small " aria-disabled="false"> <span class="absolute left-0 -mt-12 h-32 w-1/2 translate-x-[250%] rotate-12 bg-white opacity-20 transition-all duration-250 ease-out group-hover:translate-x-[2%]"></span> Me contacter </a> </div> </div> </nav> </div> </div> </header> <script type="module">const m=document.querySelectorAll(".group");m.forEach(e=>{const n=e.querySelector("a"),s=e.querySelector("button"),t=e.querySelector(".submenu"),c=t?.querySelectorAll("a");t&&n&&s&&(e.addEventListener("mouseenter",()=>{l(t,s)}),e.addEventListener("mouseleave",()=>{i(t,s)}),n.addEventListener("keydown",o=>{o.key==="ArrowDown"&&e.children&&(o.preventDefault(),l(t,s),c?.[0]?.focus())}),s.addEventListener("click",o=>{e.children&&(o.preventDefault(),s.getAttribute("aria-expanded")==="true"?i(t,s):(l(t,s),c?.[0]?.focus()))}),s.addEventListener("keydown",o=>{o.key==="ArrowDown"&&e.children&&(o.preventDefault(),l(t,s),c?.[0]?.focus())}),n.addEventListener("focus",()=>{i(t,s)}),c?.forEach((o,d)=>{o.addEventListener("keydown",r=>{const v=c.length-1;switch(r.key){case"ArrowDown":r.preventDefault(),d<v&&c[d+1].focus();break;case"ArrowUp":r.preventDefault(),d>0?c[d-1].focus():(n.focus(),i(t,s));break;case"Escape":r.preventDefault(),i(t,s),n.focus();break;case"Tab":i(t,s);break}})}),document.addEventListener("focusin",o=>{e&&!e.contains(o.target)&&i(t,s)}))});function l(e,n){e.classList.remove("invisible","opacity-0"),e.classList.add("visible","opacity-100"),n.setAttribute("aria-expanded","true")}function i(e,n){e.classList.add("invisible","opacity-0"),e.classList.remove("visible","opacity-100"),n.setAttribute("aria-expanded","false")}document.querySelectorAll(".mobile-submenu-button").forEach(e=>{e.addEventListener("click",()=>{const n=e.parentElement?.nextElementSibling,s=e.querySelector("svg");if(n){n.classList.toggle("hidden"),s?.classList.toggle("rotate-180");const t=n.classList.contains("hidden")?"false":"true";e.setAttribute("aria-expanded",t)}})});const y=document.querySelector(".mobile-menu-button"),a=document.querySelector(".mobile-menu"),u=document.querySelector(".menu-icon"),f=document.querySelector(".close-icon");y?.addEventListener("click",()=>{a?.classList.contains("hidden")?(document.body.style.overflow="hidden",a?.classList.remove("hidden"),requestAnimationFrame(()=>{a?.classList.remove("opacity-0","scale-95"),a?.classList.add("opacity-100","scale-100")}),u?.classList.add("hidden"),f?.classList.remove("hidden")):(document.body.style.overflow="",a?.classList.add("opacity-0","scale-95"),a?.classList.remove("opacity-100","scale-100"),setTimeout(()=>{a?.classList.add("hidden")},200),u?.classList.remove("hidden"),f?.classList.add("hidden"))});</script>  <section class="w-full border-b pt-38 pb-18 relative"> <div class="absolute inset-0 left-0 top-0 w-full h-full overflow-hidden">  <div class="hero-background absolute inset-0 left-0 top-0 w-full h-full overflow-hidden" style="opacity: 1;"></div> </div> <div class="site-container mx-auto px-4 relative z-10"> <div> <h1 class="text-white" data-aos="fade-up">Créez votre entreprise</h1> <p class="subtitle text-white" data-aos="fade-up" data-aos-delay="100">Formulaire de création d&#39;entreprise</p> </div> </div> </section> <section class="bg-background-base py-responsive"> <div class="site-container px-4"> <div class="grid grid-cols-1 md:grid-cols-3 gap-8"> <div> <div class="flex items-center flex-col justify-center w-max"> <div class="flex flex-col items-center"> <!-- Bloc cercle + label --> <div class="relative flex items-center justify-center"> <!-- Label --> <div class="absolute left-full ml-4 top-1/2 -translate-y-1/2 w-max"> <h6 class="text-sm font-semibold text-slate-900"> Informations personnelles </h6> </div> <!-- Cercle --> <div class="w-7 h-7 border-2 flex items-center justify-center rounded-full border-green-500"> <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 fill-green-500" viewBox="0 0 24 24"> <path d="M9.707 19.121a.997.997 0 0 1-1.414 0l-5.646-5.647a1.5 1.5 0 0 1 0-2.121l.707-.707a1.5 1.5 0 0 1 2.121 0L9 14.171l9.525-9.525a1.5 1.5 0 0 1 2.121 0l.707.707a1.5 1.5 0 0 1 0 2.121z"></path> </svg>   </div> </div> <!-- Ligne --> <div class="w-0.5 h-4 md:h-16 bg-green-500"></div> </div><div class="flex flex-col items-center"> <!-- Bloc cercle + label --> <div class="relative flex items-center justify-center"> <!-- Label --> <div class="absolute left-full ml-4 top-1/2 -translate-y-1/2 w-max"> <h6 class="text-sm font-semibold text-slate-900"> Informations entreprise </h6> </div> <!-- Cercle --> <div class="w-7 h-7 border-2 flex items-center justify-center rounded-full border-green-500"> <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 fill-green-500" viewBox="0 0 24 24"> <path d="M9.707 19.121a.997.997 0 0 1-1.414 0l-5.646-5.647a1.5 1.5 0 0 1 0-2.121l.707-.707a1.5 1.5 0 0 1 2.121 0L9 14.171l9.525-9.525a1.5 1.5 0 0 1 2.121 0l.707.707a1.5 1.5 0 0 1 0 2.121z"></path> </svg>   </div> </div> <!-- Ligne --> <div class="w-0.5 h-4 md:h-16 bg-green-500"></div> </div><div class="flex flex-col items-center"> <!-- Bloc cercle + label --> <div class="relative flex items-center justify-center"> <!-- Label --> <div class="absolute left-full ml-4 top-1/2 -translate-y-1/2 w-max"> <h6 class="text-sm font-semibold text-slate-900"> Récapitulatif </h6> </div> <!-- Cercle --> <div class="w-7 h-7 border-2 flex items-center justify-center rounded-full border-green-500">  <span class="w-3 h-3 bg-green-500 rounded-full"></span>  </div> </div> <!-- Ligne --> <div class="w-0.5 h-4 md:h-16 bg-gray-300"></div> </div><div class="flex flex-col items-center"> <!-- Bloc cercle + label --> <div class="relative flex items-center justify-center"> <!-- Label --> <div class="absolute left-full ml-4 top-1/2 -translate-y-1/2 w-max"> <h6 class="text-sm font-semibold text-slate-400"> Paiement </h6> </div> <!-- Cercle --> <div class="w-7 h-7 border-2 flex items-center justify-center rounded-full border-gray-300">   <span class="w-3 h-3 bg-gray-300 rounded-full"></span> </div> </div> <!-- Ligne -->  </div> </div> </div> <div class="md:col-span-2"> <h3 class="text-xl-2 font-semibold mb-4">Récapitulatif de vos informations</h3> <form id="recap-form"> <div id="recap-container" class="space-y-4 text-small mb-4"></div> <div class="mb-4"> <label class="flex items-center space-x-2"> <input type="checkbox" id="certify" required class="w-4 h-4 text-primary border-gray-300 rounded"> <span class="text-sm text-gray-700">Je certifie que les informations fournies sont exactes et accepte que ma demande soit transmise pour traitement.</span> </label> </div> <div class="flex justify-between my-8"> <a href="/forms/create/business" class="group relative inline-flex overflow-hidden items-center justify-center rounded-border-small font-medium transition-all duration-300 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 rounded-md flex items-center gap-2 bg-primary text-white hover:bg-primary-light focus-visible:ring-primary hover:ring-2 hover:ring-primary hover:ring-offset-2 h-10 px-4 py-2 text-small uppercase" aria-disabled="false"> <span class="absolute left-0 -mt-12 h-32 w-1/2 translate-x-[250%] rotate-12 bg-white opacity-20 transition-all duration-250 ease-out group-hover:translate-x-[2%]"></span> Étape précédente </a> <button id="submit-formality" type="submit" class="group relative inline-flex overflow-hidden items-center justify-center rounded-border-small font-medium transition-all duration-300 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 rounded-md flex items-center gap-2 bg-primary text-white hover:bg-primary-light focus-visible:ring-primary hover:ring-2 hover:ring-primary hover:ring-offset-2 h-10 px-4 py-2 text-small uppercase" aria-disabled="false"> <span class="absolute left-0 -mt-12 h-32 w-1/2 translate-x-[250%] rotate-12 bg-white opacity-20 transition-all duration-250 ease-out group-hover:translate-x-[2%]"></span> Envoyer </button> </div> </form> </div> </div> </div> </section> <script type="module" src="/_astro/CreateRecapitulatifInfo.astro_astro_type_script_index_0_lang.aTjjCWRD.js"></script> <script type="module">
    import { generateRecapPdf } from '/src/utils/generateRecapPdf.js';

    document.addEventListener('DOMContentLoaded', async () => {
        /* CONFIG */

        const STORAGE_KEY_ENTREPRENEUR = 'create-entrepreneur-form';
        const STORAGE_KEY_BUSINESS = 'create-business-form';

        const recapContainer = document.getElementById('recap-container');
        const form = document.getElementById('recap-form');

        if (!recapContainer || !form) return;

        const countries = await fetch('/data/countries.json').then((r) => r.json());

        const entrepreneur = JSON.parse(localStorage.getItem(STORAGE_KEY_ENTREPRENEUR) || '{}');
        const business = JSON.parse(localStorage.getItem(STORAGE_KEY_BUSINESS) || '{}');

        /* HELPERS */

        const formatCountry = (code) => {
            if (!code) return '-';
            const c = countries.find((x) => x.code === code);
            return c ? c.name : code;
        };

        const formatNationality = (code) => {
            if (!code) return '-';
            const c = countries.find((x) => x.code === code);
            return c ? c.nationality || c.name : code;
        };

        const capitalizeWords = (v = '') =>
            v
                .toLowerCase()
                .split(' ')
                .map((w) => w.charAt(0).toUpperCase() + w.slice(1))
                .join(' ');

        const formatDateFR = (dateStr) => {
            if (!dateStr) return '-';
            const [y, m, d] = dateStr.split('-');
            return `${d}/${m}/${y}`;
        };

        const createLine = (label, values) => `
        <div class="flex justify-between border-b border-gray-200 py-1">
            <span class="font-medium">${label}</span>
            <span class="text-gray-600 text-right">${Array.isArray(values) ? values.filter(Boolean).join('<br>') : values || '-'}</span>
        </div>
        `;

        const createSection = (title, rows) => {
            const section = document.createElement('div');
            section.className = 'bg-white rounded-sm p-4 shadow-xs';

            section.innerHTML = `
            <h3 class="text-lg font-semibold mb-4">${title}</h3>
            <div class="space-y-1">${rows.join('')}</div>
            `;

            return section;
        };

        /* DISPLAY RECAP */

        const displayRecap = () => {
            recapContainer.innerHTML = '';

            const addressParts = [
                `${entrepreneur.tracknumber || ''} ${entrepreneur.complementnumber || ''} ${entrepreneur.tracktype || ''} ${entrepreneur.way || ''} ${entrepreneur.additionaladdress || ''}`.trim(),
                `${entrepreneur.zipcode || ''} ${entrepreneur.city || ''} ${formatCountry(entrepreneur.country) || ''}`.trim(),
            ];

            // ---------------- ENTREPRENEUR ----------------
            if (Object.keys(entrepreneur).length) {
                // INFORMATIONS PERSONELLES
                const rows = [
                    createLine('Genre', capitalizeWords(entrepreneur.gender)),
                    createLine('Nom de naissance', (entrepreneur.birthname || '').toUpperCase()),
                ];
                if (entrepreneur.name) rows.push(createLine("Nom d'usage", (entrepreneur.name || '').toUpperCase()));

                rows.push(
                    createLine('Prénom', capitalizeWords(entrepreneur.firstname)),
                    createLine('Email', entrepreneur.email),
                    createLine('Téléphone', entrepreneur.phone),
                    createLine('Adresse', addressParts),
                    createLine('Date de naissance', formatDateFR(entrepreneur.birthdate)),
                    createLine('Pays de naissance', formatCountry(entrepreneur.birthcountry)),
                    createLine('Ville de naissance', capitalizeWords(entrepreneur.birthcity)),
                    createLine('Département de naissance', entrepreneur.birthdepartment),
                    createLine('Nationalité', formatNationality(entrepreneur.nationality)),
                    createLine('Assurance santé', entrepreneur.insuranceorganization === 'Autre'
                            ? entrepreneur.otherhealthinsurance
                            : entrepreneur.insuranceorganization,
                    ),
                );

                if (entrepreneur.healthinsurance)
                    rows.push(createLine('N° Sécurité sociale', entrepreneur.healthinsurance));

                rows.push(
                    createLine('Situation', entrepreneur.situation),
                    createLine('Profession actuelle', business.otheractivity === 'Autre'
                            ? business.otheractivitydetail || '-'
                            : business.otheractivity,
                    ),
                );
                recapContainer.appendChild(createSection('Informations personnelles', rows));

                // INFO CONJOINT
                if (entrepreneur.partnerbirthname) {
                    const partnerAddress = [
                        `${entrepreneur.partnertracknumber || ''} ${entrepreneur.partnercomplementnumber || ''} ${entrepreneur.partnertracktype || ''} ${entrepreneur.partnerway || ''} ${entrepreneur.partneradditionaladdress || ''}`.trim(),
                        `${entrepreneur.partnerzipcode || ''} ${entrepreneur.partnercity || ''} ${formatCountry(entrepreneur.partnercountry) || ''}`.trim(),
                    ];
                    const rows = [
                        createLine('Genre', capitalizeWords(entrepreneur.partnergender)),
                        createLine('Nom de naissance', (entrepreneur.partnerbirthname || '').toUpperCase()),
                    ];

                    if (entrepreneur.partnername)
                        rows.push(createLine("Nom d'usage", (entrepreneur.partnername || '').toUpperCase()));

                    rows.push(
                        createLine('Prénom', capitalizeWords(entrepreneur.partnerfirstname)),
                        createLine('Fonction', capitalizeWords(entrepreneur.partnerfonction)),
                    );

                    if (entrepreneur.partnerfonction != 'Aucun') {
                        rows.push(
                            createLine('Date de naissance', formatDateFR(entrepreneur.partnerbirthdate)),
                            createLine('Pays de naissance', formatCountry(entrepreneur.partnerbirthcountry)),
                            createLine('Nationalité', formatNationality(entrepreneur.partnernationality)),
                        );
                    }
                    if (entrepreneur.partneraddress === 'non') rows.push(createLine('Adresse', partnerAddress));
                    else rows.push(createLine('Adresse', addressParts));
                    recapContainer.appendChild(createSection('Informations du conjoint', rows));
                }
            }

            // ---------------- BUSINESS ----------------
            if (Object.keys(business).length) {
                const businessAddress = `${business.tracknumber || ''} ${business.complementnumber || ''} ${business.tracktype || ''} ${business.way || ''}, ${business.zipcode || ''} ${business.city || ''}`;

                let rows = [];
                // INFORMATION SUR L'ANCIENNE ACTIVITE DEJA EXERCEE
                if (business.previousselfemployedactivity === 'oui') {
                    rows = [
                        createLine("Pays de l'activité déjà exercée", formatCountry(business.sirencountry)),
                        createLine("Date de fin de l'activité déjà exercée", formatDateFR(business.oldactivitydate)),
                        createLine("Description de l'activité déjà exercée", business.oldactivity),
                    ];
                }
                if (business.sirencountry === 'FR')
                    rows.push(createLine("Siren d'activité déjà exercée", business.siren));
                if (business.previousselfemployedactivity === 'oui')
                    recapContainer.appendChild(createSection('Activité déjà exercée', rows));

                // INFORMATION DE L'ENTREPRISE
                rows = [createLine('Micro-entreprise', business.micro)];

                rows.push(
                    createLine('Déclaration URSSAF', business.insuranceorganization),
                    createLine("Contrat d'appui", business.supportcontract),
                    createLine("Demande d'ACCRE", business.accre),
                );
                if (business.domiciliationname)
                    rows.push(createLine('Organisme de domiciliation', business.domiciliationname));
                if (business.domiciliationsiren)
                    rows.push(createLine('Siren de domiciliation', business.domiciliationsiren));
                recapContainer.appendChild(createSection("Informations de l'entreprise à créer", rows));

                // ACTIVITES DE L'ENTREPRISE
                rows = [
                    createLine("Description de l'activité", business.activity),
                    createLine("Forme de l'activité", business.formofactivity),
                ];

                if (business.businessname) rows.push(createLine('Nom commercial', business.businessname));

                if (business.way) rows.push(createLine("Adresse de l'établissement", businessAddress));
                else rows.push(createLine("Adresse de l'établissement", addressParts));

                recapContainer.appendChild(createSection("Informations de l'activité de l'entreprise à créer", rows));

                // ACTIVITÉS SECONDAIRES
                const secondary = [];
                const n = parseInt(business.nbrofactivies || 0);

                for (let i = 0; i < n; i++) {
                    const desc = business[`secondaryActivities[${i}][description]`];
                    const form = business[`secondaryActivities[${i}][form]`];

                    if (desc) secondary.push({ desc, form });
                }

                if (secondary.length) {
                    const section = document.createElement('div');
                    section.className = 'bg-white rounded-sm p-4 shadow-xs';

                    section.innerHTML = `
                    <h3 class="text-lg font-semibold mb-4">Activités secondaires</h3>
                    <div class="space-y-4">
                        ${secondary.map((a) => `
                        <div class="border border-gray-400 bg-gray-50 rounded-sm overflow-hidden">
                            
                            <!-- Description -->
                            <div class="p-3 text-sm bg-white">
                                <p class="font-semibold mb-1">Description de l'activité</p>
                                <p class="text-gray-700 whitespace-pre-line leading-relaxed">${a.desc}</p>
                            </div>

                            <!-- Séparateur -->
                            <div class="border-t border-gray-300"></div>

                            <!-- Forme -->
                            <div class="px-3 py-2 font-medium text-sm bg-gray-100 text-gray-700">
                                Forme de l’activité : <span class="text-gray-600">${a.form}</span>
                            </div>

                            </div>
                        `,).join('')}
                    </div>
                    `;
                recapContainer.appendChild(section);
                }
            }
            // OBSERVATION
            if (business.observation != '') {
                const rows = [createLine('Précision utile à votre demande', business.observation)];
                recapContainer.appendChild(createSection('Information complémentaire', rows));
            }
        };

        displayRecap();

        /* SUBMIT → GENERATE PDF */

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            const submitBtn = form.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Génération du PDF...';

            try {
                submitBtn.disabled = true;
                submitBtn.textContent = 'Génération du PDF...';

                const pdfBlob = generateRecapPdf(recapContainer, { download: false });

                if (!(pdfBlob instanceof Blob) || pdfBlob.size === 0)
                    throw new Error('Le PDF généré est vide ou invalide.');
        
                // Convertir en base64 pour stockage temporaire
                const reader = new FileReader();

                reader.onloadend = () => {
                sessionStorage.setItem("generatedPdf", reader.result);
                };

                reader.readAsDataURL(pdfBlob);

                submitBtn.textContent = 'Envoi en cours...';

                // Gestion de la création
                const formData = new FormData();
                formData.append('typeFormaliteId', '1');
                formData.append('name', entrepreneur.name);
                formData.append('email', entrepreneur.email);
                formData.append('phone', entrepreneur.phone);
                formData.append('city', entrepreneur.city);
                formData.append('zipcode', entrepreneur.zipcode);
                formData.append('pdf', pdfBlob, 'recap.pdf');

                console.log(formData)

                const response = await fetch('/api/create', {
                    method: 'POST',
                    body: formData,
                });

                const data = await response.json();

                if (!response.ok)
                    throw new Error(data.error || "Erreur lors de l'envoi du mail.");

                // ✅ Succès total
                submitBtn.textContent = 'Envoyé ✔';
                // localStorage.clear();
                
                window.location.href = `/confirmation?token=${data.token}`;
            } catch (e) {
                console.error(e);

                submitBtn.disabled = false;
                submitBtn.textContent = 'Envoyer';

                alert(e.message || 'Une erreur est survenue.');
            }
        });
    });
</script>  <footer class="bg-black text-white pb-small "> <div class="site-container mx-auto px-4"> <div class="text-center border-b border-background-light mb-12 py-small"> <h2 class="text-3xl font-bold mb-4" data-aos="fade-up">Besoin d&#39;aide ?</h2> <p class="text-white mb-6 max-w-2xl mx-auto" data-aos="fade-up" data-aos-delay="100"> Confiez-moi vos formalités dès aujourd’hui. Je vous aide à sécuriser vos démarches administratives en toute simplicité. Contactez-moi pour en discuter. </p> <a data-aos="fade-up" data-aos-delay="200" href="/contact" class="group relative inline-flex overflow-hidden items-center justify-center rounded-border-small font-medium transition-all duration-300 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 rounded-md flex items-center gap-2 text-white ring-2 ring-white focus-visible:ring-white hover:ring-2 hover:ring-black hover:ring-offset-2 h-11 px-8 text-base " aria-disabled="false" target="_self"> <span class="absolute left-0 -mt-12 h-32 w-1/2 translate-x-[250%] rotate-12 bg-white opacity-20 transition-all duration-250 ease-out group-hover:translate-x-[2%]"></span> Me contacter </a> </div> <div class="grid grid-cols-1 md:grid-cols-4 gap-8 pb-8 border-b border-background-light"> <div class="col-span-1"> <a href="/" class="logo uppercase font-logo transition-colors duration-200 font-light text-footer-logo hover:text-primary">  <img src="/_astro/astro.CXuftnGC_ZFt1Ax.svg" alt loading="lazy" decoding="async" fetchpriority="auto" width="115" height="48" class="hidden"> <div class="full-logo"><span class="font-bold">Mon Assistant</span> Formalités</div> <div class="min-logo"><span class="font-bold">MAF</span></div> </a> <p class="mt-4 text-white">
Gain de temps, conformité, tranquillité d’esprit. .
</p> </div> <div class="col-span-1"> <h3 class="text-lg font-semibold mb-4"></h3> <nav> <ul class="space-y-2"> <!-- {footerMenu.map(item => (
              <li><a href={item.link} class="text-body-dark hover:text-white transition-colors">{item.name}</a></li>
            ))} --> </ul> </nav> </div> </div> <div class="mt-8 flex flex-col md:flex-row justify-between items-center"> <div class="text-body-dark text-sm">
© 2026 Mon Assistant Formalités. Tous droits réservés.
</div> <nav class="mt-4 md:mt-0"> <ul class="flex flex-wrap gap-6"> <li> <a href="/legal/privacy-policy" class="text-sm text-body-dark hover:text-white transition-colors"> Politique de confidentialité </a> </li><li> <a href="/legal/general-conditions-of-sale" class="text-sm text-body-dark hover:text-white transition-colors"> Conditions Générales de ventes </a> </li><li> <a href="/legal/legal-notices" class="text-sm text-body-dark hover:text-white transition-colors"> Mentions légales </a> </li> </ul> </nav> </div> </div> </footer>  <script type="module" src="/_astro/Layout.astro_astro_type_script_index_0_lang.Cqrgs33o.js"></script> </body> </html>